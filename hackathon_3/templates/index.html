
<!DOCTYPE html>
<html>
<head>
  <title>micro:bit Lab Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <h2>Live Sensor Data</h2>
  <p>Time: <span id="time">-</span></p>
  <p>Value: <span id="value">-</span></p>
  <canvas id="chart" width="800" height="400"></canvas>

  <script>
    const chart = new Chart(document.getElementById('chart'), {
      type: 'line',
      data: { labels: [], datasets: [{ label: 'Sensor', data: [] }] },
      options: { animation: false }
    });

    async function fetchData() {
      const res = await fetch('/api/data');
      const d = await res.json();
      document.getElementById('time').innerText = d.time;
      document.getElementById('value').innerText = d.value;

      chart.data.labels.push(d.time);
      chart.data.datasets[0].data.push(d.value);

      if (chart.data.labels.length > 50) {
        chart.data.labels.shift();
        chart.data.datasets[0].data.shift();
      }
      chart.update();
    }
    setInterval(fetchData, 1000);
  </script>
</body>
</html>
